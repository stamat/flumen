/*!
 * Flumen MINIFIED v1.0.0
 *
 * License MIT
 *
 * http://stamat.github.io/flumen
 * Copyright 2017 Stamat
 */

!function(e){e.fn.addClassIncrement=function(t,n){var r=e(this);t||(t="num");for(var i=0;i<r.length;i++){var l=e(r[i]);l.data("number",i).addClass(t+"-"+i),n&&n(i,l)}return r},e.fn.flumen=function(t){function n(t,n){var r=a.map[t];n||(n=a.speed);var i=r.start;a.center&&(i-=a.half_width-r.half_width-a.margin),c=!0,e(this).trigger("flumen.beforechange",a),o.stop(!0).animate({scrollLeft:i},n,function(){e(this).trigger("flumen.afterchange",a)})}function r(){var e=o.scrollLeft();a.center&&(e+=a.half_width);for(var t in a.map){var n=a.map[t];if(e>=n.start&&e<=n.outerEnd)return n}return null}function i(e){var t=a.map[e],n=t.start;a.center&&(n-=a.half_width-t.half_width-a.margin),o.scrollLeft(n)}function l(){e(this).trigger("flumen.beforeresize",a),a.width=o.width(),!a.cloned_left&&a.loop&&(a.cloned_left=a.children.clone(!0).addClass("clone clone-left"),a.cloned_right=a.children.clone(!0).addClass("clone clone-right"),o.prepend(a.cloned_left),o.append(a.cloned_right),a.children=o.children());var t=o.scrollLeft();o.scrollLeft(0);for(var n=0;n<a.children.length;n++){var r=e(a.children[n]),i=r.width(),l=r.outerWidth(!0),c=r.position().left,u={elem:r,width:i,start:a.center?c:c-a.margin,end:a.center?c+i:c+a.margin+i,outerEnd:c+l,outerWidth:l,id:n,num:n%a.items,half_width:i/2};r.hasClass("clone")?u.cloned=!0:a.orig_map[u.num]=u,a.map[n]=u}a.loop?(a.end_position=a.map[3*a.items-1].start+a.map[3*a.items-1].width-a.width-s,a.reset_left=a.map[a.items].start+s,a.reset_right=a.map[2*a.items-1].start+a.map[2*a.items-1].width-a.width-s):a.end_position=a.map[a.items-1].start+a.map[a.items-1].width-a.width,a.half_width=a.width/2,o.scrollLeft(t),e(this).trigger("flumen.afterresize",a)}var o=e(this),s=50,a={loop:!0,center:!0,fluid:!0,arrows:!1,dots:!1,mousewheel:!1,speed:300,margin:0,resize_timeout:200};e.extend(a,t),a.fluid&&(o.kinetic(),o.mousewheel(function(e){o.scrollLeft(o.scrollLeft()+e.deltaX)})),a.children=o.children().addClass("flumen-slide"),a.original=a.children,a.margin&&a.original.css("margin","0px "+a.margin+"px"),a.items=a.children.length,a.children.addClassIncrement(),a.map={},a.orig_map={};var c=!1,u=null;e(window).resize(function(){u||(u=setTimeout(function(){clearTimeout(u),u=null,l()},a.resize_timeout))}),l(),a.start_num=0,a.loop&&(a.start_num=a.items),i(a.start_num),a.current=null;var d=null;o.scroll(function(t){var n=o.scrollLeft();a.loop?(n<=s&&(e(this).trigger("flumen.start",a),o.scrollLeft(a.reset_left)),n>=a.end_position&&(e(this).trigger("flumen.end",a),o.scrollLeft(a.reset_right))):(0===n&&e(this).trigger("flumen.start",a),n>=a.end_position&&e(this).trigger("flumen.end",a));var i=r();!i||a.current&&a.current.id===i.id||(a.current=i,e(this).trigger("flumen.slide",i)),d&&clearTimeout(d),d=setTimeout(function(){o.trigger("flumen.stop",a),d=null},100)}),a.center||a.loop||o.trigger("scroll"),o.on("flumen.goto",function(e,t){n(a.start_num+t-1)}),o.on("flumen.left",function(e){n(a.current.id-1)}),o.on("flumen.right",function(e){n(a.current.id+1)}),o.on("flumen.slide",function(e,t){console.log(t.num)}),o.on("flumen.stop",function(e,t){t.current.cloned&&c&&(c=!1,i(t.orig_map[t.current.num].id))}),o.on("flumen.remove",function(e,t){}),e(this).trigger("flumen.init",a)}}(jQuery);