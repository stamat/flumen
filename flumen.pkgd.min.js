/*!
 * Flumen PACKAGED v1.0.0
 *
 * License MIT
 *
 * http://stamat.github.io/flumen
 * Copyright 2017 Stamat
 */

!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t:t(jQuery)}(function(t){function e(e){var l=e||window.event,r=a.call(arguments,1),h=0,u=0,d=0,p=0,f=0,m=0;if(e=t.event.fix(l),e.type="mousewheel","detail"in l&&(d=l.detail*-1),"wheelDelta"in l&&(d=l.wheelDelta),"wheelDeltaY"in l&&(d=l.wheelDeltaY),"wheelDeltaX"in l&&(u=l.wheelDeltaX*-1),"axis"in l&&l.axis===l.HORIZONTAL_AXIS&&(u=d*-1,d=0),h=0===d?u:d,"deltaY"in l&&(d=l.deltaY*-1,h=d),"deltaX"in l&&(u=l.deltaX,0===d&&(h=u*-1)),0!==d||0!==u){if(1===l.deltaMode){var v=t.data(this,"mousewheel-line-height");h*=v,d*=v,u*=v}else if(2===l.deltaMode){var g=t.data(this,"mousewheel-page-height");h*=g,d*=g,u*=g}if(p=Math.max(Math.abs(d),Math.abs(u)),(!o||p<o)&&(o=p,s(l,p)&&(o/=40)),s(l,p)&&(h/=40,u/=40,d/=40),h=Math[h>=1?"floor":"ceil"](h/o),u=Math[u>=1?"floor":"ceil"](u/o),d=Math[d>=1?"floor":"ceil"](d/o),c.settings.normalizeOffset&&this.getBoundingClientRect){var w=this.getBoundingClientRect();f=e.clientX-w.left,m=e.clientY-w.top}return e.deltaX=u,e.deltaY=d,e.deltaFactor=o,e.offsetX=f,e.offsetY=m,e.deltaMode=0,r.unshift(e,h,u,d),n&&clearTimeout(n),n=setTimeout(i,200),(t.event.dispatch||t.event.handle).apply(this,r)}}function i(){o=null}function s(t,e){return c.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120===0}var n,o,l=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],r="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],a=Array.prototype.slice;if(t.event.fixHooks)for(var h=l.length;h;)t.event.fixHooks[l[--h]]=t.event.mouseHooks;var c=t.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var i=r.length;i;)this.addEventListener(r[--i],e,!1);else this.onmousewheel=e;t.data(this,"mousewheel-line-height",c.getLineHeight(this)),t.data(this,"mousewheel-page-height",c.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var i=r.length;i;)this.removeEventListener(r[--i],e,!1);else this.onmousewheel=null;t.removeData(this,"mousewheel-line-height"),t.removeData(this,"mousewheel-page-height")},getLineHeight:function(e){var i=t(e),s=i["offsetParent"in t.fn?"offsetParent":"parent"]();return s.length||(s=t("body")),parseInt(s.css("fontSize"),10)||parseInt(i.css("fontSize"),10)||16},getPageHeight:function(e){return t(e).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})}),function(t){"use strict";var e="kinetic-active";window.requestAnimationFrame||(window.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){window.setTimeout(t,1e3/60)}}()),t.support=t.support||{},t.extend(t.support,{touch:"ontouchend"in document});var i=function(){return!1},s=function(e,i){return this.settings=i,this.el=e,this.$el=t(e),this._initElements(),this};s.DATA_KEY="kinetic",s.DEFAULTS={cursor:"move",decelerate:!0,triggerHardware:!1,threshold:0,y:!0,x:!0,slowdown:.9,maxvelocity:40,throttleFPS:60,movingClass:{up:"kinetic-moving-up",down:"kinetic-moving-down",left:"kinetic-moving-left",right:"kinetic-moving-right"},deceleratingClass:{up:"kinetic-decelerating-up",down:"kinetic-decelerating-down",left:"kinetic-decelerating-left",right:"kinetic-decelerating-right"}},s.prototype.start=function(e){this.settings=t.extend(this.settings,e),this.velocity=e.velocity||this.velocity,this.velocityY=e.velocityY||this.velocityY,this.settings.decelerate=!1,this._move()},s.prototype.end=function(){this.settings.decelerate=!0},s.prototype.stop=function(){this.velocity=0,this.velocityY=0,this.settings.decelerate=!0,t.isFunction(this.settings.stopped)&&this.settings.stopped.call(this)},s.prototype.detach=function(){this._detachListeners(),this.$el.removeClass(e).css("cursor","")},s.prototype.attach=function(){this.$el.hasClass(e)||(this._attachListeners(this.$el),this.$el.addClass(e).css("cursor",this.settings.cursor))},s.prototype._initElements=function(){this.$el.addClass(e),t.extend(this,{xpos:null,prevXPos:!1,ypos:null,prevYPos:!1,mouseDown:!1,throttleTimeout:1e3/this.settings.throttleFPS,lastMove:null,elementFocused:null}),this.velocity=0,this.velocityY=0,t(document).mouseup(t.proxy(this._resetMouse,this)).click(t.proxy(this._resetMouse,this)),this._initEvents(),this.$el.css("cursor",this.settings.cursor),this.settings.triggerHardware&&this.$el.css({"-webkit-transform":"translate3d(0,0,0)","-webkit-perspective":"1000","-webkit-backface-visibility":"hidden"})},s.prototype._initEvents=function(){var e=this;this.settings.events={touchStart:function(t){var i;e._useTarget(t.target,t)&&(i=t.originalEvent.touches[0],e.threshold=e._threshold(t.target,t),e._start(i.clientX,i.clientY),t.stopPropagation())},touchMove:function(t){var i;e.mouseDown&&(i=t.originalEvent.touches[0],e._inputmove(i.clientX,i.clientY),t.preventDefault&&t.preventDefault())},inputDown:function(t){e._useTarget(t.target,t)&&(e.threshold=e._threshold(t.target,t),e._start(t.clientX,t.clientY),e.elementFocused=t.target,"IMG"===t.target.nodeName&&t.preventDefault(),t.stopPropagation())},inputEnd:function(t){e._useTarget(t.target,t)&&(e._end(),e.elementFocused=null,t.preventDefault&&t.preventDefault())},inputMove:function(t){e.mouseDown&&(e._inputmove(t.clientX,t.clientY),t.preventDefault&&t.preventDefault())},scroll:function(i){t.isFunction(e.settings.moved)&&e.settings.moved.call(e,e.settings),i.preventDefault&&i.preventDefault()},inputClick:function(t){if(Math.abs(e.velocity)>0)return t.preventDefault(),!1},dragStart:function(t){if(e._useTarget(t.target,t)&&e.elementFocused)return!1}},this._attachListeners(this.$el,this.settings)},s.prototype._inputmove=function(e,i){var s=this.$el;this.el;if((!this.lastMove||new Date>new Date(this.lastMove.getTime()+this.throttleTimeout))&&(this.lastMove=new Date,this.mouseDown&&(this.xpos||this.ypos))){var n=e-this.xpos,o=i-this.ypos;if(this.threshold>0){var l=Math.sqrt(n*n+o*o);if(this.threshold>l)return;this.threshold=0}this.elementFocused&&(t(this.elementFocused).blur(),this.elementFocused=null,s.focus()),this.settings.decelerate=!1,this.velocity=this.velocityY=0;var r=this.scrollLeft(),a=this.scrollTop();this.scrollLeft(this.settings.x?r-n:r),this.scrollTop(this.settings.y?a-o:a),this.prevXPos=this.xpos,this.prevYPos=this.ypos,this.xpos=e,this.ypos=i,this._calculateVelocities(),this._setMoveClasses(this.settings.movingClass),t.isFunction(this.settings.moved)&&this.settings.moved.call(this,this.settings)}},s.prototype._calculateVelocities=function(){this.velocity=this._capVelocity(this.prevXPos-this.xpos,this.settings.maxvelocity),this.velocityY=this._capVelocity(this.prevYPos-this.ypos,this.settings.maxvelocity)},s.prototype._end=function(){this.xpos&&this.prevXPos&&this.settings.decelerate===!1&&(this.settings.decelerate=!0,this._calculateVelocities(),this.xpos=this.prevXPos=this.mouseDown=!1,this._move())},s.prototype._useTarget=function(e,i){return!t.isFunction(this.settings.filterTarget)||this.settings.filterTarget.call(this,e,i)!==!1},s.prototype._threshold=function(e,i){return t.isFunction(this.settings.threshold)?this.settings.threshold.call(this,e,i):this.settings.threshold},s.prototype._start=function(t,e){this.mouseDown=!0,this.velocity=this.prevXPos=0,this.velocityY=this.prevYPos=0,this.xpos=t,this.ypos=e},s.prototype._resetMouse=function(){this.xpos=!1,this.ypos=!1,this.mouseDown=!1},s.prototype._decelerateVelocity=function(t,e){return 0===Math.floor(Math.abs(t))?0:t*e},s.prototype._capVelocity=function(t,e){var i=t;return t>0?t>e&&(i=e):t<0-e&&(i=0-e),i},s.prototype._setMoveClasses=function(t){var e=this.settings,i=this.$el;i.removeClass(e.movingClass.up).removeClass(e.movingClass.down).removeClass(e.movingClass.left).removeClass(e.movingClass.right).removeClass(e.deceleratingClass.up).removeClass(e.deceleratingClass.down).removeClass(e.deceleratingClass.left).removeClass(e.deceleratingClass.right),this.velocity>0&&i.addClass(t.right),this.velocity<0&&i.addClass(t.left),this.velocityY>0&&i.addClass(t.down),this.velocityY<0&&i.addClass(t.up)},s.prototype._move=function(){var e=(this.$el,this.el),i=this,s=i.settings;s.x&&e.scrollWidth>0?(this.scrollLeft(this.scrollLeft()+this.velocity),Math.abs(this.velocity)>0&&(this.velocity=s.decelerate?i._decelerateVelocity(this.velocity,s.slowdown):this.velocity)):this.velocity=0,s.y&&e.scrollHeight>0?(this.scrollTop(this.scrollTop()+this.velocityY),Math.abs(this.velocityY)>0&&(this.velocityY=s.decelerate?i._decelerateVelocity(this.velocityY,s.slowdown):this.velocityY)):this.velocityY=0,i._setMoveClasses(s.deceleratingClass),t.isFunction(s.moved)&&s.moved.call(this,s),Math.abs(this.velocity)>0||Math.abs(this.velocityY)>0?this.moving||(this.moving=!0,window.requestAnimationFrame(function(){i.moving=!1,i._move()})):i.stop()},s.prototype._getScroller=function(){var e=this.$el;return(this.$el.is("body")||this.$el.is("html"))&&(e=t(window)),e},s.prototype.scrollLeft=function(t){var e=this._getScroller();return"number"!=typeof t?e.scrollLeft():(e.scrollLeft(t),void(this.settings.scrollLeft=t))},s.prototype.scrollTop=function(t){var e=this._getScroller();return"number"!=typeof t?e.scrollTop():(e.scrollTop(t),void(this.settings.scrollTop=t))},s.prototype._attachListeners=function(){var e=this.$el,s=this.settings;t.support.touch&&e.bind("touchstart",s.events.touchStart).bind("touchend",s.events.inputEnd).bind("touchmove",s.events.touchMove),e.mousedown(s.events.inputDown).mouseup(s.events.inputEnd).mousemove(s.events.inputMove),e.click(s.events.inputClick).scroll(s.events.scroll).bind("selectstart",i).bind("dragstart",s.events.dragStart)},s.prototype._detachListeners=function(){var e=this.$el,s=this.settings;t.support.touch&&e.unbind("touchstart",s.events.touchStart).unbind("touchend",s.events.inputEnd).unbind("touchmove",s.events.touchMove),e.unbind("mousedown",s.events.inputDown).unbind("mouseup",s.events.inputEnd).unbind("mousemove",s.events.inputMove),e.unbind("click",s.events.inputClick).unbind("scroll",s.events.scroll).unbind("selectstart",i).unbind("dragstart",s.events.dragStart)},t.Kinetic=s,t.fn.kinetic=function(e,i){return this.each(function(){var n=t(this),o=n.data(s.DATA_KEY),l=t.extend({},s.DEFAULTS,n.data(),"object"==typeof e&&e);o||n.data(s.DATA_KEY,o=new s(this,l)),"string"==typeof e&&o[e](i)})}}(window.jQuery||window.Zepto),function(t){t.fn.addClassIncrement=function(e,i){var s=t(this);e||(e="num");for(var n=0;n<s.length;n++){var o=t(s[n]);o.data("number",n).addClass(e+"-"+n),i&&i(n,o)}return s},t.fn.flumen=function(e){function i(e,i){var s=a.map[e];i||(i=a.speed);var n=s.start;a.center&&(n-=a.half_width-s.half_width-a.margin),h=!0,t(this).trigger("flumen.beforechange",a),l.stop(!0).animate({scrollLeft:n},i,function(){t(this).trigger("flumen.afterchange",a)})}function s(){var t=l.scrollLeft();a.center&&(t+=a.half_width);for(var e in a.map){var i=a.map[e];if(t>=i.start&&t<=i.outerEnd)return i}return null}function n(t){var e=a.map[t],i=e.start;a.center&&(i-=a.half_width-e.half_width-a.margin),l.scrollLeft(i)}function o(){t(this).trigger("flumen.beforeresize",a),a.width=l.width(),!a.cloned_left&&a.loop&&(a.cloned_left=a.children.clone(!0).addClass("clone clone-left"),a.cloned_right=a.children.clone(!0).addClass("clone clone-right"),l.prepend(a.cloned_left),l.append(a.cloned_right),a.children=l.children());var e=l.scrollLeft();l.scrollLeft(0);for(var i=0;i<a.children.length;i++){var s=t(a.children[i]),n=s.width(),o=s.outerWidth(!0),h=s.position().left,c={elem:s,width:n,start:a.center?h:h-a.margin,end:a.center?h+n:h+a.margin+n,outerEnd:h+o,outerWidth:o,id:i,num:i%a.items,half_width:n/2};s.hasClass("clone")?c.cloned=!0:a.orig_map[c.num]=c,a.map[i]=c}a.loop?(a.end_position=a.map[3*a.items-1].start+a.map[3*a.items-1].width-a.width-r,a.reset_left=a.map[a.items].start+r,a.reset_right=a.map[2*a.items-1].start+a.map[2*a.items-1].width-a.width-r):a.end_position=a.map[a.items-1].start+a.map[a.items-1].width-a.width,a.half_width=a.width/2,l.scrollLeft(e),t(this).trigger("flumen.afterresize",a)}var l=t(this),r=50,a={loop:!0,center:!0,fluid:!0,arrows:!1,dots:!1,mousewheel:!1,speed:300,margin:0,resize_timeout:200};t.extend(a,e),a.fluid&&(l.kinetic(),l.mousewheel(function(t){l.scrollLeft(l.scrollLeft()+t.deltaX)})),a.children=l.children().addClass("flumen-slide"),a.original=a.children,a.margin&&a.original.css("margin","0px "+a.margin+"px"),a.items=a.children.length,a.children.addClassIncrement(),a.map={},a.orig_map={};var h=!1,c=null;t(window).resize(function(){c||(c=setTimeout(function(){clearTimeout(c),c=null,o()},a.resize_timeout))}),o(),a.start_num=0,a.loop&&(a.start_num=a.items),n(a.start_num),a.current=null;var u=null;l.scroll(function(e){var i=l.scrollLeft();a.loop?(i<=r&&(t(this).trigger("flumen.start",a),l.scrollLeft(a.reset_left)),i>=a.end_position&&(t(this).trigger("flumen.end",a),l.scrollLeft(a.reset_right))):(0===i&&t(this).trigger("flumen.start",a),i>=a.end_position&&t(this).trigger("flumen.end",a));var n=s();!n||a.current&&a.current.id===n.id||(a.current=n,t(this).trigger("flumen.slide",n)),u&&clearTimeout(u),u=setTimeout(function(){l.trigger("flumen.stop",a),u=null},100)}),a.center||a.loop||l.trigger("scroll"),l.on("flumen.goto",function(t,e){i(a.start_num+e-1)}),l.on("flumen.left",function(t){i(a.current.id-1)}),l.on("flumen.right",function(t){i(a.current.id+1)}),l.on("flumen.slide",function(t,e){console.log(e.num)}),l.on("flumen.stop",function(t,e){e.current.cloned&&h&&(h=!1,n(e.orig_map[e.current.num].id))}),l.on("flumen.remove",function(t,e){}),t(this).trigger("flumen.init",a)}}(jQuery);